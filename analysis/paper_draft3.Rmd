---
title: "Bayesian Detection of Bias in Peremptory Challenges Using Historical Strike Data"
date: "`r Sys.Date()`"
blinded: 0
authors:
- name: "[Sachin S. Pandya](https://orcid.org/0000-0001-7387-1307)"
  #thanks: The authors gratefully acknowledge ...
  affiliation: University of Connecticut
  email: sachin.pandya@uconn.edu
- name: "Xiaomeng Li"
  affiliation: University of Connecticut
- name: "[Eric Barón](https://orcid.org/0000-0003-1934-1932)"
  affiliation: University of Connecticut
- name: "[Timothy E. Moore](https://orcid.org/0000-0002-9576-0517)"
  affiliation: University of Connecticut
output:
  bookdown::pdf_book: 
      base_format: rticles::asa_article
      citation_package: "default"
      keep_tex: TRUE
header-includes: 
  - \usepackage{amsmath}
#fontsize: 12pt
bibliography: references.bib
biblio-style: agsm.bst
nocite: |
  @WashR37, @calccp2021
keywords: "Batson challenge, peremptory strikes, power prior, Bayesian"
abstract: |
  US law bars using peremptory strikes during jury selection because of prospective juror race, ethnicity, sex, or membership in certain other cognizable classes. Here, we extend a Bayesian approach for detecting such illegal bias. We show how to incorporate historical data on an attorney's use of peremptory strikes in past cases to estimate how likely that attorney has struck prospective jurors in a current trial because of their cognizable-class membership. In so doing, we use the power prior to adjust the weight of such historical information in the analysis. We show how well our model performs on simulated data. Finally, we extend this approach with a prototype software application to detect bias in peremptory-challenge in real time during jury-selection. We illustrate this application's use with historical strike data from a convenience sample of cases from one court.

---

```{r setup, include=FALSE}

library(ggplot2)
library(dplyr)

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

```

# Introduction

In the United States, individuals selected for jury-service appear in court as scheduled and are questioned by the parties' attorneys and the trial judge. During this process, a prospective juror, if not excused by the trial judge for cause, may still be dismissed if a party's attorney uses one of their limited number of peremptory challenges against them. By asserting a peremptory challenge, a party can declare a prospective juror ineligible ("strikes" that juror) for a seat on the jury without the burden of explaining why.

Since _Batson v. Kentucky_ [-@batson1986], a party violates the Equal Protection Clause of the US Constitution by using peremptory challenges if motivated by the prospective jurors' race, ethnicity, sex, or certain other cognizable classes. The party bringing a _Batson_ challenge bears the burden of proving such illegal bias is more likely than not to be true [@LaFave2022, $\S$ 22.3(d)]. 

A _Batson_ challenge typically proceeds in a four-step sequence. The attorney must decide whether to challenge the opposing attorney's use of one or more peremptory strikes as based on illegal bias. If challenged, the challenger must meet an initial burden (the _prima facie_ case) of producing just enough evidence of strike bias to raise a sufficient initial inference of illegal bias. If so, then at the next step, the striking attorney must proffer permissible reasons for their challenged strikes. Finally, the challenger must discredit those proffered reasons and ultimately persuade the trial judge that it is more likely than not that the striking attorney acted with illegal bias.

For similar challenges under State law, a few States require only that an "objective observer" or an "objectively reasonable person" would find that race, ethnicity or another cognizable-class was a "factor" in that party's use of strikes [Wash. General Rule 37(e); Calif. Code of Civil Procedure $\S$ 231.7(d)(1); Conn. Superior Court Rule 5-12(d)]. Peremptory-challenge procedure, and thus the task of proving such illegal bias, varies not only by State, but also by court, including the number of peremptory challenges assigned to each side and the order in which each party uses those strikes [@nscs-jury2018; @Williams2017].

In any case, evidence of such illegal bias may include data on a party's use of peremptory challenges in past cases [@flowers2019, 2243; Wash. General Rule 37(g)(v); Calif. Code Civil Procedure $\S$ 231.7(d)(3)(G)]. Prior studies have collected such historical strike data in past cases and reported the observed difference in strike rates by race or sex. Typically, they test for the probability of observing a non-zero difference in strike rates by the race or sex of the struck prospective jurors, given repeated sampling from a hypothetical population of peremptory strikes with zero such difference [e.g., @Eisenberg2017; @Grosso2012; for discussion, see @Gastwirth2014, 289-297; @Gastwirth2013]. Prior studies have also modeled how much a prospective juror's race affected the odds of being struck. For different modeling approaches using the same historical strike data from Mississippi, see @Craft2018a; @DeCamp2021; and @Dunn2022. 

In turn, the inference of bias based in part on historical strike data is relevant to lawyers for deciding whether to argue a _Batson_ violation, establishing a prima facie case, and proving that bias in the particular case is more likely than not (Figure \@ref(fig:batsonworkflowfig)).


```{r batsonworkflowfig, fig.cap="Inference from Historical Strike Data for  Batson Challenge", fig.align = 'center', out.width="100%", fig.pos = "h"}

load_path <- here::here("figures","batson_workflow_fig2.pdf")
knitr::include_graphics(load_path)

```


In this paper, we extend a Bayesian approach to _Batson_ and similar challenges [@Kadane2021; @Kadane2018a; @Kadane2018b] to incorporate historical strike data. In this approach, we use two steps. In step one, we specify a model of the peremptory-strike process in the court of interest that includes a bias parameter to which we assign an initial prior distribution. We use an attorney's strike data from past trials, as generated by that same peremptory-strike process, to estimate a posterior distribution for that bias parameter. We use the power prior [@Chen2000; @Ibrahim2015] to control how much the strike history from past cases affects the posterior distribution of the bias parameter. In step two, we estimate the posterior distribution of the bias parameter from the current case, using the posterior distribution developed with the historical information and the power prior. 

Here, we demonstrate this approach with simulation studies. Then, we present a software prototype that encodes the same approach with actual historical strike data to help attorneys and others detect bias in peremptory-challenge use in real time during jury selection.

# Methods

## Statistical Procedure

Following others [e.g., @Kadane2018a; @Barrett2007; @Gastwirth2005, 183], we model a peremptory-challenge process in which each party strikes prospective jurors in an alternating sequence. Under such a procedure, the trial judge rules on all challenges for cause before the parties exercise any peremptories. Then, of the potential jurors who remain, a subset of them are subject to peremptory strike, usually a number that corresponds to the number seats on the jury (plus alternates, if any). The parties exercise their strikes on anyone among this subset of potential jurors in an alternating sequence. Once all strikes are used or waived, the remaining prospective jurors are each assigned to seats on the jury plus a few alternate jurors.

Accordingly, for any given case $i$ in which jury selection occurs, let $j$ denote a peremptory strike used, and let $\delta_{ij}$ denote whether or not a party used that strike on a person who belongs to a "cognizable class". If "race" is the bias type of interest, the cognizable class is racial minority jurors ($\delta_{ij} =1$, 0 for White jurors).  If "sex" is the bias of interest, the cognizable class is female jurors ($\delta_{ij} = 1$, 0 for male jurors). In turn, let $c_{ij}$ denote the number of cognizable class members subject to strike; and $m_{ij}$ denote the number of cognizable class non-members subject to strike, such that $c_{ij}+m_{ij}$ is the total number of jurors potentially subject to strike. If there is no bias, the probability is $\frac{c_{ij}}{c_{ij}+m_{ij}}$ for striking a cognizable class member, and $1-\frac{c_{ij}}{c_{ij}+m_{ij}}$ for striking someone who does not belong to that class.

By adding one parameter $w$, we can measure _bias_ by different values of $w$ by defining the probability of a cognizable class member being struck to be $\frac{wc_{ij}}{wc_{ij}+m_{ij}}$. To avoid making the weight of the non-cognizable class be the reciprocal of the weight of cognizable class, let $b = log(w)$. 

Accordingly, for any given value of the bias parameter $b$, the probability of strike of a member from either class, or $Pr(\delta_{ij})$, is such that:

\begin{equation}
Pr(\delta_{ij} | b) = 
\begin{cases}
  \frac{(e^b)c_{ij}}{(e^b)c_{ij}+m_{ij}} & \text{for }\delta_{ij}=1\\    
  \frac{m_{ij}}{(e^b)c_{ij}+m_{ij}} & \text{for }\delta_{ij}=0  \label{eq:model1}
\end{cases} 
\end{equation} This Equation \eqref{eq:model1} is equivalent to

\begin{equation}
Pr(\delta_{ij}| b) = \left(\frac{(e^b)c_{ij}}{(e^b)c_{ij}+m_{ij}}\right)^{\delta_{ij}} \left(\frac{m_{ij}}{(e^b)c_{ij}+m_{ij}}\right)^{1-\delta_{ij}}
\label{eq:model2}
\end{equation}

Given the strike data we have, i.e., $\delta_{ij}$, $c_{ij}$, and $m_{ij}$, by estimating the value of $b$, we can measure bias when a party is striking potential jurors. If $b = 0$, there is no bias, and the probability of strike is simply a function of the share of cognizable members (non-members) in the pool of prospective jurors that could be struck. If $b>0$, we infer that the the party has bias favoring a strike against a juror falling within the cognizable class (e.g., the juror is a racial minority). Where $b<0$, the party has a preference for a juror within the cognizable class. 

The likelihood function of $b$ is

\begin{equation}  
L(b|\delta) = \prod_{i=1}^{n_i} \prod_{j=1}^{n_j}\left(\frac{(e^b)c_{ij}}{(e^b)c_{ij}+m_{ij}}\right)^{\delta_{ij}} \left(\frac{m_{ij}}{(e^b)c_{ij}+m_{ij}}\right)^{1-\delta_{ij}}
\label{eq:model3}
\end{equation} where $n_{i}$ is the total number of jury selections (trials), $n_j$ is the total number of peremptory strikes, and $\delta=(\delta_{11},\dots,\delta_{12},\dots,\delta_{{n_i}{n_j}})$ 

## Incorporating historical strike data

We incorporate data on strikes in past cases and allow for adjustment of the weight of that historical strike data on the posterior distribution of the bias parameter. To do this, we introduce the power prior:

\begin{equation}  
\pi(b|\delta_0,\alpha_0) \propto L(b|\delta_0)^{\alpha_0}\pi_0(b)
\label{eq:powerprior}
\end{equation} where $0 \le \alpha_0 \le 1$ is the parameter controlling the weight of the historical information; $\delta_0=(\delta_{011},\dots,\delta_{012},\dots,\delta_{0{n_i}{n_j}})$ is the observed historical data; $L(b|\delta_0)$ is the likelihood function of $b$ given the historical data; and $\pi_0(b)$ is the initial prior before the historical data is observed. 

In this paper, we assume that the law for _Batson_ and similar challenges entails a weakly-informative initial prior:

\begin{equation}  
\pi_0(b) \sim Normal(\mu = 0, \sigma = 2)
\label{eq:initialprior}
\end{equation}

For this initial prior, we let $\mu = 0$, because the law assigns the burden of proof in a _Batson_ challenge to the party bringing the challenge. Thus, if the challenging party produces no relevant evidence of illegal bias, the law requires a trial judge to reject the challenge as unproven. This is tantamount to treating zero as the most-likely value of the bias parameter, absent any data. Moreover, we take the law to imply that, absent any data, one must assume that higher degrees of illegal bias are less likely than lower degrees of bias. For this reason, we use a normal (Gaussian) distribution with $\sigma = 2$. This prior accords with @Kadane2021 [p. 51], who suggests a prior for estimating _Batson_ strike bias that is at least unimodal, symmetric, and not dependent on the data.

After including the historical information through the power prior, the posterior distribution of $b$ is proportional to the product of likelihood function of $b$ and the power prior of $b$ is 

\begin{equation}
 \pi(b|\delta,\delta_0) \propto L(b|\delta)L(b|\delta_0)^{\alpha_0}\exp\left(-\frac{(b-\mu)^2}{2\sigma^2}\right)
  \label{eq:model4}
\end{equation} where 

\begin{equation}
L(b|\delta_0) = \prod_{i=1}^{n_{0i}} \prod_{j=1}^{n_{0j}}\left(\frac{(e^b)c_{0ij}}{(e^b)c_{0ij}+m_{0ij}}\right)^{\delta_{0ij}} \left(\frac{m_{0ij}}{(e^b)c_{0ij}+m_{0ij}}\right)^{1-\delta_{0ij}}
\label{eq:model5}
\end{equation} is the likelihood function of $b$ given historical data; $n_{0i}$ is the total number of jury selections (trials) in the historical data; $n_{0j}$ is the total number of peremptory strikes in the historical data; and $\delta_{0ij}$ denotes whether or not a party used that strike on a person who belongs to a cognizable class in the historical trials. 

## Model Performance on Simulated Data

To evaluate the proposed method, we conducted a simulation study using Stan `r rstan::stan_version()`, a Hamiltonian Monte Carlo engine for Bayesian inference by way of `r R.version$version.string` and RStan [@rstan]. <!--To measure convergence, we used trace plots, the Gelman-Rubin convergence diagnostic and Geweke’s diagnostics [@Gelman1992;@Gelman1998;@Geweke1992].--> These simulations primarily show how much our ability to detect bias was affected the size of the historical data and by how much the power prior discounted the weight of the historical data. As introduced above, $b > 0$ represents a prosecutor's bias against a prospective juror within the cognizable class, while $b = 0$ denotes no bias. For simplicity, we assume the defense attorney has no bias.

Because we use the power prior, we can control how much we account for the historical strike data by modifying the discounting parameter $\alpha$ (denoted as $\alpha_0$ in Equations \@ref(eq:powerprior) and \@ref(eq:model4)). If $\alpha=1$, the historical strike data is equally weighted with the data on strikes in the current trial. If $\alpha<1$, the historical data are discounted and weighted proportionally less than the current trial data. We assign $\alpha<1$ to evaluate how sensitive the posterior of the bias parameter is to the historical data on strikes. Accordingly, in the simulation study, we evaluated different values of $\alpha$: $\alpha=\{0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1\}$ to show how that parameter affected bias detection.

We generated historical strike data of three sizes (same, double, and triple the size of current data, i.e., data on one previous trial, two previous trials) using seven different values of the bias parameter for generating that historical data $b_{hist}=\{0,0.5,1,1.5,2, 2.5,3\}$. 

To generate data, we generated strike data for a current trial using seven different values of the bias parameter $b_{curr}=\{0,0.5,1,1.5,2, 2.5,3\}$. To evaluate the strength of the power prior as a function of the degree of incompatibility between current and historical strike data ($\lvert b_{curr} - b_{hist} \rvert > 0$), we assigned $b_{hist}$ the same bias values as $b_{curr}$, i.e., $b_{hist}=\{0,0.5,1,1.5,2, 2.5,3\}$. We did this to simulate noise in the historical strike data that can arise due to not-at-random missingness or because a confounder (e.g. charge severity) affects $b_{curr}$ but not of all the past trials in the historical strike data.

For our simulation, we define bias detection as the proportion of times we identify bias when bias is present in the current trial, i.e., $b_{curr} > 0$ , based on whether credible intervals of the bias parameter exclude zero. Since we use a weakly-informative prior that pulls the estimate of $b_{curr}$ towards zero, we focus on how accurately our model can detect that bias, _not_ on how accurately the model can recover the true value of $b_{curr}$ (i.e., a traditional coverage rate). For instance, a 90\% bias detection rate means that in 900 of 1000 model fits, a given credible interval does not contain zero if the $b_{curr}$ is not zero. Put another way, if we set $b_{curr}>0$, we calculate the proportion of the 90\% credible intervals that lie to the right of zero (lower bound is positive) among the 1000 model fits. For each scenario, we generated 1000 data sets and fit the model on those data sets. For each replicate, we generate a MCMC sample of 10,000 iterations with a burn-in period of 1000 iterations. For each replicate, we calculate the posterior mean and $80\%$, $90\%$, and $95\%$ highest posterior density intervals for $b_{curr}$.

Additionally, we present sensitivity analysis for the number of available strikes per trial (6 strikes, 10 strikes, and 15 strikes for each attorney). Thus, in total, we considered 4851 different scenarios, i.e. the combination of 7 different bias parameters of current data and of historical data, 3 different amounts of historical data, 11 different values for the power prior weight parameter, and for 3 combinations of the total number of strikes. 

```{r figbd9515, out.width = "95%", fig.cap = "Bias Detection Rates, 95 pct credible interval, 15 strike scenario", fig.align='center'}

load_path <- here::here("figures","pp15_95CI.png")
knitr::include_graphics(load_path)

```

Figure \@ref(fig:figbd9515) depicts the bias detection rate with an 95\% credible interval for the 15 strikes scenario. When $b_{curr}$ is high (close to 3) the bias detection rate is high (very close to 1). However, when $b_{curr}$ is lower (close to zero), the bias detection rate drops below 0.8. When there is no bias in the current or historical trials ($b_{curr} = b_{hist} = 0$), the bias detection rate for the 95% credible interval is 0.05 or less. As we place more weight on the historical strike data (as $\alpha$ increases), and the historical strike data is consistent with current information (high compatibility), the bias detection rate is close to 1, especially when bias is high (upper right-hand corner of plots). Conversely, as $\alpha$ decreases, bias detection is only high when there is high bias in the current trial ($b_{curr} \geq 1.5$). Increasing the number of historical trials leads to an increase in bias detection especially when current and historical trials are compatible.


```{r figbd9510, out.width = "95%", fig.cap = "Bias Detection Rates (95 pct credible interval, 10 strikes scenario)", fig.align='center'}

load_path <- here::here("figures","pp10_95CI.png")
knitr::include_graphics(load_path)

```

```{r figbd956, out.width = "95%", fig.cap = "Bias Detection Rates based on 95 pct credible interval for 6 strike scenario", fig.align='center'}

load_path <- here::here("figures","pp6_95CI.png")
knitr::include_graphics(load_path)

```

As we decrease the number of strikes each attorney has from fifteen to ten and six (Figures \@ref(fig:figbd9510) and \@ref(fig:figbd956) respectively), bias detection decreases. Bias detection is only high when $\alpha$ is high (close to 1); current trial bias is high; there is high compatibility between current and historical trials; and the number of historical trials is large.

Using a wider credible interval lowers this chance of error. For example, with a 90\% credible interval (Figure \@ref(fig:figbd9510)), when $b_{curr}=2$, the bias-detection rate is lower than with an 80\% credible interval; when $b_{curr}=0$, that detection rate is higher. The tradeoff is lower accuracy. With a 90\% credible interval, when the bias parameter is 2, the model is less accurate in detecting bias. When the bias parameter is 3, however, the detection rate is still high.

Bias detection will also be sensitive to the choice of the standard deviation of the initial prior ($\sigma$). The results above depend in part on our choice of a conservative initial prior for the bias parameter (Equation \@ref(eq:initialprior)). Given little historical strike data for an attorney and a low number of strikes per trial, this initial prior will dominate. As a result, the model we use will only detect severe bias. This sensitivity, however, reduces after including the historical data, especially when $\alpha$ is close to 1.


```{r figsdprior, out.width = "95%", fig.cap = "Sensitivity to Initial Prior's Standard Deviation", fig.align='center'}

load_path <- here::here("figures","SD_sensitivity.jpg")
knitr::include_graphics(load_path)

```

Figure \@ref(fig:figsdprior) depicts how assigning different values for the initial prior’s standard deviation ($\sigma = \{1,2,100\}$) affects the bias detection rate at the 95\% credible interval for three $\alpha$ values ($\alpha = \{0.1,0.5,1\}$) under scenarios where each attorney had 10 strikes and where $b_{curr} = b_{hist}$. In our simulations, we set $\sigma = 2$ for our initial prior. If we instead select $\sigma = 1$, that matters most when $\alpha = 0.1$, i.e., when we borrow less information from the historical data. As $\alpha$ increases, the initial prior's standard deviation matters less. Moreover, when we increased the initial prior's standard deviation to make it much less informative ($\sigma = 100$), that had little impact on bias detection rates, regardless of the choice of $\alpha$.

```{r figcmptbly, out.width = "95%", fig.cap = "Compatibility", fig.align='center'}

load_path <- here::here("figures","compatibility_plot.jpg")
knitr::include_graphics(load_path)

```

Finally, Figure \@ref(fig:figcmptbly) summarizes our simulation results for bias detection at the 95% credible interval, given perfect compatibility ($b_{curr} = b_{hist}$). These results indicate that our model can accurately detect strong bias if present in both the current and historical trials. Given high compatibility, increasing $\alpha$ improves bias detection, as does increasing the number of historical trials and more strikes per trial. Under the low number of strikes per trial (n = 6), bias detection requires strong bias in the current trial and a high $\alpha$.

## Simultaneous Strikes {#simul-strikes}

In some courts, both parties simultaneously exercise their peremptory challenges on the prospective jurors subject to strikes. This simultaneous-strikes process can be modeled as a special case of the model of an alternating-strikes process above (see Equation \@ref(eq:model3)), i.e, as equivalent to one party engaging in an uninterrupted sequence of strikes against a subset of prospective jurors eligible to be struck. The premise: Regardless of the order in which a party announced those strikes, the posterior for the bias parameter would be the same.

To test this premise, we conducted the following simulation study. We first generated a single trial in which one attorney used fifteen strikes in an uninterrupted sequence against 30 prospective jurors, 15 of which were member of a cognizable-class (e.g., Black jurors).  Then, we shuffled the order of those strikes to generate 50 trials with the same proportion of struck cognizable-class members but different orders. We then fit the model to the 50 trials to examine whether the estimated bias parameters across the 50 simulated trials were equivalent.

```{r fig-simul, out.width = "75%", fig.cap="Simulation results for simultaneous strikes example. Columns correspond to values of bias ($b_{curr}$) used to simulate data. Points and horizontal lines denote estimated posterior mean and 95 pct. credible interval for bias parameter. Vertical dashed lines denote true value of $b_{curr}$ in the simulations.", fig.align='center'}

load_path <- here::here("figures","simultaneous_sims_plot.jpg")
knitr::include_graphics(load_path)

```

Figure \@ref(fig:fig-simul) depicts the results of the simultaneous strike simulations. We find the estimated bias parameter of the 50 trials with different strike orders are close to each other for all of the three scenarios. None of their credible intervals include zero. This shows that the order of strikes does not influence the estimate of the bias parameter. Accordingly, the simultaneous-strikes process can be modeled as a special case of our initial model of an alternating-strikes process with an identical likelihood.

## The Software Prototype {#prototype}

We describe here a prototype software application ("app") that implements the approach described above and that attorneys and others can use in real time to detect bias in the use of peremptory challenges. We built this app with `r R.version$version.string` and the shiny package [@R; @shiny]. Unlike the simulations, we built the app using Rcpp [@Rcpp] and the Metropolis-Hasting algorithm to sample $b$ from the posterior distribution. To show how lawyers might use this app in real cases in real time during selection, we loaded this app with actual strike data from a convenience sample of attorneys who appeared during jury selection in criminal cases in the federal district court for Connecticut during fiscal years 2013 through 2017.

To collect this historical strike data, one of us filed a request with the U.S. District Court of Connecticut based on 28 U.S.C. $\S$ 1868.  Thereafter, we received copies of certain jury-selection records associated with twenty-nine criminal cases in that court during this period. These included strike sheets that indicated the identification number of prospective jurors who were struck by peremptory challenge, the order in which they were struck, and which side (prosecutor or defense) struck which juror. Such records also included a tally of answers to juror questionnaires that asked each prospective juror to report their race and gender.

These records, however, often did not indicate the identity of the attorneys exercising the strikes. While the standard forms included a signature line for the attorney, many were left blank or filled with illegible signatures.  Accordingly, we turned to the publicly-available docket sheets for each case for the names of the lawyers who appeared in the case on behalf of the prosecution (the US Attorney's office) or the criminal defendant(s) on the date(s) of jury selection. Where only a single attorney represented a party during jury selection, it was easy to attribute the pattern of strikes to that attorney. Where multiple lawyers appeared for one side, we attributed to each of them that side's pattern of peremptory challenges in that case. In such cases, neither the jury-selection documents nor the docket sheets indicated any hierarchy among multiple lawyers or any other basis to attribute strikes to only one attorney among them. After generating a dataset based on these documents, we kept only strikes where a criminal defendant was represented by an attorney. Finally, to de-identify this dataset, we excluded defendant names and substituted fictitious names for the attorneys using the charlatan package [@charlatan].

With the app, the user uses the pull-down menus to select the cognizable class (top left) and enters by hand the strike information in the case before them in the _strike tally_ table (bottom left). For demonstration purposes, the prototype app comes pre-loaded with a completed strike tally with values that can be changed and rows that can be added or deleted. In the strike tally, `round` denotes the order of strikes, `num_cog` denotes the number of prospective jurors that could be struck that belong to the cognitive class; `total` denotes the total number of prospective jurors that could be struck; `cog` indicates whether the prospective juror actually struck in that round was a member of the cognizable class (1 = yes, 0 = no); and `party` indicates which side used the strike (PP = prosecutor, PD = defense attorney).

For the prototype app, we set two cognizable-class options: race and gender. This was because the standard juror questionnaire did not ask about other possible cognizable classes. The data also did not expressly indicate the race or gender of the criminal defendant(s).

In the default setting, the pull-down menus for prosecutor and defense are set to "None". As a result, the app ignores any historical strike data and estimates the posterior distributions of the bias parameter for prosecutor and defense based only on the strike tally data and the initial prior ($b \sim N(0,2)$). Historical data will be included if the name(s) of a prosection or defense attorney are selected from the pull-down menu. Subsequently, the amount of historical data to be borrowed can be selected by the choice of $\alpha$. 

```{r inpts}
df <- data.frame(round = c(1:10),
                 num_cog = c(5,5,4,3,2,2,2,2,2,2),
                 total = c(21,20,19,18,17,16,15,14,13,12),
                 cog = c(0,1,1,0,0,1,1,0,0,0),
                 party = rep(c("PP","PD"),5))

knitr::kable(df, caption ="Hypothetical Strike Tally", format = "latex", booktabs = TRUE)

```

To illustrate, suppose the strike tally in Table 1 depicts the pattern of strikes in the present case with defense attorney Aaron Waelchi and prosecutor Lawrance Klocko V (both aliases for actual attorneys in the historical strike data). After the user enters this strike tally, the app initially displays two graphs -- one for the prosecution and the defense. Each graph depicts the prior density plot (colored light grey) and posterior density plot (blue and red for defense and prosecution, respectively) for the bias parameter (Figure \@ref(fig:figapp1)). Here, the 80\% credible interval includes zero, indicating no credible basis to infer bias, given the current strike tally.

```{r figapp1, out.width='75%', fig.cap = "Screenshot of R-Shiny application showing density plots for bias of prosecutor and defense attorney based on data in 'Current strike tally' table. Vertical dotted lines depict 80 pct. credible interval.", fig.align='center'}

load_path <- here::here("figures","batson_app_screenshots", "batson_app_screenshot1.png")
knitr::include_graphics(load_path)

```

To use historical strike data, the user selects a name of the prosecutor or defense attorney from the pull-down menus. If an attorney's name cannot be found, the app has no historical strike data for that attorney. Once selected, the prior and posterior density plots automatically update to account for the pre-loaded historical strike data for that attorney. For the weight to assign that attorney's historical strike data, the default is set to equal weight of historical information and current information ($\alpha = 1$). The user has two other options: half weight ($\alpha = 0.5$) and minimal weight ($\alpha = 0.2$).

In our illustration, we select the names of the prosecutor and defense attorney from their respective pull-down menus; and leave the weight setting to "Equal". The density plots update accordingly (Figure \@ref(fig:figapp2)).

```{r figapp2, out.width='75%', fig.cap = "Density Plots with Historical Strike Data (Race). Screenshot of R-Shiny application show density plots based on historical and current strike data for prosecutor and defense attorney.", fig.align='center'}

load_path <- here::here("figures","batson_app_screenshots", "batson_app_screenshot2.png")

knitr::include_graphics(load_path)

```

Now, the credible intervals clearly exclude zero. Thus, we have a credible basis to infer bias against racial-minority prospective jurors in how these attorney use their peremptory challenges in the present case. In the Appendix, we present additional illustrations wherein the app is used to detect gender bias and where we assign less weight to the historical strike data. 

# Discussion

Statistical methods for _Batson_ and similar challenges aim to help measure how much prospective jurors' race, gender, or other cognizable-class membership affected an attorney's use of peremptory strikes against them. The Bayesian approach here accounts for available historical strike data when estimating the posterior for the bias parameter. By incorporating the power prior, one can easily assess how sensitive that posterior estimate is to the available historical strike data.

Moreover, with a tool like our prototype app, attorneys can use the approach here in to better detect strike bias for _Batson_ and related challenges. The posterior distribution of the striking attorney's bias parameter can help the lawyer decide in real time whether it is worth arguing a  _Batson_ challenge at all. If argued, the attorney can introduce that posterior distribution as relevant evidence for presenting a prima facie case and of ultimately proving illegal bias (Figure \@ref(fig:batsonworkflowfig)). To be sure, such evidence alone cannot account for the veracity of the striking attorney's proferred reasons. Besides, _Batson_ procedure allows any type of evidence, not just statistical evidence, for ultimately proving or disproving illegal bias in the particular case. Thus, as with any use of historical strike data, the approach here cannot always determine whether a _Batson_ challenge should succeed or fail.

The approach here also requires more from those who would collect the appropriate historical strike data. For example, given the model we used, we required data on the cognizable-class composition of the prospective jurors not just at the time of the first strike, but at each time either party used a strike. 

Moreover, suppose an attorney of interest exercised strikes in two courts, each with different strike procedures. In some cases, one court's strike procedure can be modeled as a special case of a more general model that can be applied to another court's procedure (e.g., the simultaneous strike example in section \@ref(simul-strikes) ). In other cases, however, one cannot apply the same model to courts with different jury selection practices. For example, the model we used here does not apply to strike data generated by a court's strike procedure in which prospective jurors appear before the attorneys one at a time to be either struck or seated on the jury.

Furthermore, the bias detection rate depends on the degree of incompatibility between the bias parameters for the current trial and for the past (historical) trials ($\lvert b_{curr} - b_{hist} \rvert$). These bias parameters may be incompatible ($b_{curr} \neq b_{hist}$) for at least two reasons.

First, such incompatibility may occur because of missing historical data. Historical strike data tends to be incomplete at best, because jury-selection records in past cases are hard to get due to court practices and other barriers [@Grosso2017; @Wright2018]. For example, some jurisdictions do not require recording relevant or detailed enough information about prospective jurors who were or could have been struck (e.g., their race or gender). And judges and court staff vary in how often they fully complete or maintain the information they are required to record.  This presents an obstacle for any approach to detecting strike bias, including but not limited to the one here, if the missing data is missing not at random.

US law currently affords a way to ameliorate this missing data problem. The public has a presumptive First Amendment right to attend jury voir dire in criminal cases, even if prosecutor and defendant agree to exclude the public. Similarly, a criminal defendant has a Sixth Amendment right to a public trial that presumptively precludes excluding the public from the voir dire of prospective jurors [@press1984; @presley2010]. If these rights are asserted, any person can often attend jury voir dire and collect relevant strike data based on what they observe in real time.  Thus, though historical strike data is hard to collect retrospectively, such courtroom observers can prospectively build up a dataset for strike data that they would have been less likely to obtain from court records after the fact.

Second, even with complete strike data (no missingness), incompatibility may occur if attorney bias depends on certain trial-level characteristics (e.g., defendant race, charge severity) that take on one value in the current trial but that vary across the historical trials. For example, suppose an attorney who is more likely to strike Black prospective jurors because the defendant is Black; who has zero strike bias in cases with white defendants; and whose historical strike data comes from past trials with an equal number of Black and white defendants. If so, then bias detection in the current trial with a Black defendant may depend in part on whether we use all the historical data or only the subset of past trials with Black defendants.

In practice, the anticipated degree of incompatibility should influence which value of $\alpha$ to select. Given perfect compatibility ($\lvert b_{curr} - b_{hist} \rvert = 0$), we should let $\alpha = 1$ (equal weight between current and historical data). This will maximize bias detection even when the number of strikes per trial is small. This effect of increased bias detection can be seen in the simulation results depicted in Figures \@ref(fig:figbd9515), \@ref(fig:figbd9510), and \@ref(fig:figbd956) along the positive diagonals of the individual blocks.

Bias detection also increases with the number of historical trials and the number of strikes per trial. Higher values of $\alpha$ lead to higher bias detection rates across compatibility scenarios, especially in scenarios with a lower number of strikes per trial and few historical trials (top left panel of Figure \@ref(fig:figcmptbly)). The choice of $\alpha$ matters less for bias detection when bias is high; the number of strikes per trial is high; and the number of historical trials is high (lower right panel of Figure \@ref(fig:figcmptbly)). Overall, given high compatibility, increasing $\alpha$ will increase bias detection.

In cases where lawyers contest the degree of compatibility, those lawyers can and should interrogate the choice of $\alpha$ by selecting multiple $\alpha$ values and observing how sensitive the posterior distribution of the striking attorney's bias parameter is to the choice of $\alpha$ value. (Our protoype app permits this kind of testing of sensitivity in real time by providing multiple options for $\alpha$ values.) If the inference of bias is sensitive to the choice of $\alpha$ values, all else equal, then worries about incompatibility are warranted and the historical strike data, without more, is less helpful to proving a _Batson_ violation than it would otherwise would be. In any case, one virtue of this approach is that the choice of $\alpha$ explicitly and transparently denotes the degree of weight placed on the historical strike data in the analysis.

# Conclusion

In this paper, we extended a Bayesian approach to estimate attorney strike bias in the use of peremptory challenges by incorporating historical data on that attorney's use of strikes in past cases. In so doing, we used the power prior to adjust the weight of such historical information. Our simulations showed that how well our approach detects attorney bias depends on the number of past trials in which that attorney used strikes; the number of strikes per trial; and the degree of incompatibility, i.e., the distance between the bias parameters for the current trial and for the past trials. Finally, we discussed a prototype software application with which attorneys could use our approach in real time during jury selection to detect attorney strike bias.

# Acknowledgements

## CRediT Author Statement

Pandya: Conceptualization, Investigation, Software, Writing; Li: Conceptualization, Formal Analysis, Software, Writing - original draft; Barón: Formal Analysis, Software; Moore: Conceptualization, Supervision, Visualization, Writing - original draft.

# References

<div id="refs"></div>

# Appendix

Here, we extend the discussion in section \@ref(prototype) of the paper by presenting additional illustrations of how a lawyer might use the prototype app. 

Suppose the same scenario discussed in section \@ref(prototype), except now the strike tally indicates the pattern of strikes by these attorneys against female prospective jurors. If so, we select "gender" as the cognizable class, and the density plots update accordingly (Figure \@ref(fig:figapp3)).

```{r figapp3, out.width='75%', fig.cap = "Density Plots with Historical Strike Data (Gender). Screenshot of R-Shiny application show density plots based on historical and current strike data for prosecutor and defense attorney. Equal weight ($a = 1$) applied to historical and current data.", fig.align='center'}

load_path <- here::here("figures","batson_app_screenshots", "batson_app_screenshot3.png")

knitr::include_graphics(load_path)

```

Here, most of the prosecutor's density curve of both prior and posterior are to the left of zero, indicating the possible bias against male jurors. However, because the 80\% credible interval includes zero, inferring such bias from the strike data alone is unjustified. 

```{r figapp4, out.width='75%', fig.cap = "Density Plots with Historical Strike Data (Gender). Screenshot of R-Shiny application show density plots based on historical and current strike data for prosecutor and defense attorney. Minimal weight ($a = 0.1$) applied to historical data.", fig.align='center'}

load_path <- here::here("figures","batson_app_screenshots", "batson_app_screenshot4.png")

knitr::include_graphics(load_path)

```

Finally, if we assign minimal weight to the historical strike data ($a = 0.1$), the density plot updates accordingly (Figure \@ref(fig:figapp4)). Both the prior and posterior density become flatter and the credible interval plainly includes zero.
